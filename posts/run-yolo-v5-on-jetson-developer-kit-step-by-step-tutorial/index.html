<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>Run YOLO v5 on Jetson developer kit step by step tutorial | Richard&#39;s sogni d&#39;oro</title>

    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">    
<meta name="viewport" content="width=device-width,minimum-scale=1">
<meta name="description" content="Teach you how to run YOLOv5 on Jetson developer kit">

<META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">

<meta name="generator" content="Hugo 0.146.4">



<link rel="stylesheet" href="/css/style.css">


<script data-ad-client="ca-pub-3246815983951661" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>


  
    
    <link rel="stylesheet" href="https://richard-cokecola.github.io/css/chat.css">
  


<link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />

 
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HQLWYE4FVQ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HQLWYE4FVQ');
</script>



  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js" integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js" integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>




  </head>

  <body>
    <nav class="navigation">
	
		<a href="/"> <span class="arrow">←</span>Home</a>
	
	<a href="/posts">Archive</a>
	<a href="/tags">Tags</a>
	<a href="/about">About</a>

	

	
</nav>


    <main class="main">
      

<section id="single">
    <h1 class="title">Run YOLO v5 on Jetson developer kit step by step tutorial</h1>

    <div class="tip">
        <span>
          Jun 4, 2021 09:01
        </span>
        <span class="split">
          ·
        </span>
        <span>
          
            783 words
          
        </span>
        <span class="split">
          ·
        </span>
        <span>
          2 minute read
        </span>
    </div>

    
    
        <aside class="toc">
  <details>
      <summary>Table of Contents
      </summary>
      <div>
          <nav id="TableOfContents">
  <ul>
    <li><a href="#whats-the-goal">What&rsquo;s the goal?</a></li>
    <li><a href="#the-following-instructions-has-been-tested-on">The following instructions has been tested on:</a></li>
    <li><a href="#what-you-need">What you need:</a></li>
    <li><a href="#setting-up-the-enviroment">Setting up the enviroment:</a></li>
    <li><a href="#key-points">Key points:</a></li>
    <li><a href="#these-are-the-outputs-i-got">These are the outputs I got:</a></li>
    <li><a href="#references"><em>References:</em></a></li>
  </ul>
</nav>
      </div>
  </details>
</aside>
    


    <div class="content">
      <h2 id="whats-the-goal">What&rsquo;s the goal? <a href="#whats-the-goal" class="anchor"></a></h2><p>To run YOLOv5 on jetson developer kit to achieve real-time object detection.</p>
<h2 id="the-following-instructions-has-been-tested-on">The following instructions has been tested on: <a href="#the-following-instructions-has-been-tested-on" class="anchor"></a></h2><ul>
<li>Jetson nano</li>
<li>Jetson Xavier NX</li>
</ul>
<h2 id="what-you-need">What you need: <a href="#what-you-need" class="anchor"></a></h2><ul>
<li>A Jetson nano (If you are using other Jetson developer kit from Nvidia, I am sure you can take this as reference as well.)</li>
<li>A SD card and power suply which meets the needs.</li>
<li>Another computer or laptop with internet connection and built-in SD card slot or an adapter.</li>
<li>A monitor with HDMI port, a USB mouse and a USB keyboard.</li>
</ul>
<p><strong>Firsty, to start the system on Jetson developer kit, write image to microSD card.</strong></p>
<p>Download the official image file and write it in the microSD card. You can go check <a href="https://developer.nvidia.com/embedded/learn/get-started-jetson-nano-devkit" title="Nvidia tutorial"  target="_blank" rel="noopener">Nvidia official set up tutorial</a> for more information.</p>
<h2 id="setting-up-the-enviroment">Setting up the enviroment: <a href="#setting-up-the-enviroment" class="anchor"></a></h2><p><strong>Install virtualenv and virtualenvwrapper:</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#080;font-style:italic"># install pip first since there is no pip pre-installed</span>
</span></span><span style="display:flex;"><span>sudo apt-get install python3-pip
</span></span><span style="display:flex;"><span>sudo apt-get install python3-setuptools
</span></span><span style="display:flex;"><span>python3 -m pip install --upgrade pip setuptools wheel
</span></span><span style="display:flex;"><span>sudo pip3 install virtualenv virtualenvwrapper
</span></span></code></pre></div><p><strong>You can also enter administrator mode to avoid typing sudo all the time by using:</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo -i
</span></span></code></pre></div><p><strong>Modify the enviroment variable:</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#080;font-style:italic"># Install an editor first</span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">#you can also choose other editor</span>
</span></span><span style="display:flex;"><span>sudo apt-get -y install nano 
</span></span><span style="display:flex;"><span>mkdir <span style="color:#b8860b">$HOME</span>/.virtualenvs
</span></span><span style="display:flex;"><span>nano ~/.bashrc
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># Add following into the file</span>
</span></span><span style="display:flex;"><span><span style="color:#a2f">export</span> <span style="color:#b8860b">WORKON_HOME</span><span style="color:#666">=</span><span style="color:#b8860b">$HOME</span>/.virtualenvs
</span></span><span style="display:flex;"><span><span style="color:#a2f">export</span> <span style="color:#b8860b">VIRTUALENVWRAPPER_PYTHON</span><span style="color:#666">=</span>/usr/bin/python3
</span></span><span style="display:flex;"><span><span style="color:#a2f">source</span> /usr/local/bin/virtualenvwrapper.sh
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># After this, reopen the terminal</span>
</span></span></code></pre></div><p><strong>Set virtual developing enviroment:</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkvirtualenv yolov5 
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># A virtual developing enviroment named &#34;yolov5&#34; has been created</span>
</span></span></code></pre></div><p><strong>Start working on the virtual developing enviroment you just created:</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>workon yolov5
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># If &#34;(yolov5)&#34; appeared in front of your username, this means it worked</span>
</span></span></code></pre></div><p><strong>Download YOLOv5:</strong></p>
<p>There is one tricky part to run YOLOv5 on Jetson developer kit which is you <strong>MUST USE YOLOV5 V3.1</strong> otherwise it won&rsquo;t work based on my experiments. However, I also found people posted that YOLOv5 master branch worked well on Jetson as well. If you want to try the YOLOv5 master branch:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#080;font-style:italic"># install git</span>
</span></span><span style="display:flex;"><span>apt-get install git-all -y 
</span></span><span style="display:flex;"><span>git clone https://github.com/ultralytics/yolov5.git
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># Or, you can just download YOLOv5 v3.1 from their website</span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># and copy the folder into the virtual enviroment</span>
</span></span></code></pre></div><p>I used another method and it worded well. First download YOLOv5 v3.1 from <a href="https://github.com/ultralytics/yolov5/archive/refs/tags/v3.1.zip" target="_blank" rel="noopener">YOLOv5 v3.1 offocial website</a> and then copy to your vitual enviroment folder named yolov5.</p>
<p><strong>Install all the softwares:</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#080;font-style:italic"># check Jetpack version</span>
</span></span><span style="display:flex;"><span>apt-cache show nvidia-jetpack
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># Install pytorch method 1</span>
</span></span><span style="display:flex;"><span>wget https://nvidia.box.com/shared/static/9eptse6jyly1ggt9axbja2yrmj6pbarc.whl -O torch-1.6.0-cp36-cp36m-linux_aarch64.whl
</span></span><span style="display:flex;"><span>apt-get install python3-pip libopenblas-base libopenmpi-dev 
</span></span><span style="display:flex;"><span>pip3 install Cython
</span></span><span style="display:flex;"><span>pip3 install numpy torch-1.6.0-cp36-cp36m-linux_aarch64.whl
</span></span></code></pre></div><p>If there are internet issues, try:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#080;font-style:italic"># Install pytorch method 2</span>
</span></span><span style="display:flex;"><span>apt-get install python3-pip libopenblas-base libopenmpi-dev 
</span></span><span style="display:flex;"><span>pip3 install Cython
</span></span><span style="display:flex;"><span>pip3 install numpy
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># Download torch-1.6.0-cp36-cp36m-linux_aarch64.whl first then </span>
</span></span><span style="display:flex;"><span>pip3 install torch-1.6.0-cp36-cp36m-linux_aarch64.whl
</span></span></code></pre></div><p>Install torchvision from source:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#080;font-style:italic"># If you used torch 1.6, you should use torchvision 0.7</span>
</span></span><span style="display:flex;"><span>apt-get install libjpeg-dev zlib1g-dev libpython3-dev libavcodec-dev libavformat-dev libswscale-dev
</span></span><span style="display:flex;"><span>git clone --branch v0.7.0 https://github.com/pytorch/vision torchvision
</span></span><span style="display:flex;"><span><span style="color:#a2f">cd</span> torchvision
</span></span><span style="display:flex;"><span><span style="color:#a2f">export</span> <span style="color:#b8860b">BUILD_VERSION</span><span style="color:#666">=</span>0.7.0
</span></span><span style="display:flex;"><span>python3 setup.py install 
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># If having problem here, go see key point 3 below </span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># This will take a while</span>
</span></span><span style="display:flex;"><span><span style="color:#a2f">cd</span> ../
</span></span></code></pre></div><p>Install OpenCV:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#080;font-style:italic">#Link native OpenCV to the virtual enviroment</span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic">#find where the native OpenCV is</span>
</span></span><span style="display:flex;"><span>find / -name cv2 
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># It should be in /usr/lib/python3.6/dist-packages/cv2/python-3.6/</span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># You should find the .so file called &#39;cv2.cpython-36m-aarch64-linux-gnu.so&#39;</span>
</span></span><span style="display:flex;"><span>ln -s /usr/lib/python3.6/dist-packages/cv2/python-3.6/cv2.cpython-36m-aarch64-linux-gnu.so ~/.virtualenvs/<span style="color:#666">{</span>your env<span style="color:#666">}</span>/cv2.cpython-36m-aarch64-linux-gnu.so
</span></span></code></pre></div><p>After this, check if the installation is succeed:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>python
</span></span><span style="display:flex;"><span><span style="color:#666">&gt;&gt;&gt;</span> <span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">cv2</span>
</span></span><span style="display:flex;"><span><span style="color:#666">&gt;&gt;&gt;</span> <span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">torch</span>
</span></span><span style="display:flex;"><span><span style="color:#666">&gt;&gt;&gt;</span> <span style="color:#a2f;font-weight:bold">import</span> <span style="color:#00f;font-weight:bold">torchvision</span>
</span></span><span style="display:flex;"><span><span style="color:#666">&gt;&gt;&gt;</span> <span style="color:#a2f">print</span>(cv2<span style="color:#666">.</span>__version__)
</span></span><span style="display:flex;"><span><span style="color:#666">&gt;&gt;&gt;</span> <span style="color:#a2f">print</span>(torch<span style="color:#666">.</span>__version__)
</span></span><span style="display:flex;"><span><span style="color:#666">&gt;&gt;&gt;</span> <span style="color:#a2f">print</span>(torchvision<span style="color:#666">.</span>__version__)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#080;font-style:italic"># Press Ctrl+z to exit python</span>
</span></span></code></pre></div><p><p class="markdown-image">
  <img src="https://raw.githubusercontent.com/Richard-CokeCola/Richard-CokeCola.github.io/main/images/AI/env.jpg" alt="env"  title="installation succeed" />
</p>
Install the rest:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip3 install matplotlib pillow pyyaml tensorboard tqdm scipy
</span></span></code></pre></div><p>Now, you are ready to run YOLOv5! Let&rsquo;s try running YOLOv5 on defauly images:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>python detect<span style="color:#666">.</span>py <span style="color:#666">--</span>source inference<span style="color:#666">/</span>images<span style="color:#666">/</span> <span style="color:#666">--</span>weights weights<span style="color:#666">/</span>yolov5s<span style="color:#666">.</span>pt
</span></span></code></pre></div><p><strong>Congratulations!</strong></p>
<h2 id="key-points">Key points: <a href="#key-points" class="anchor"></a></h2><ol>
<li>
<p>If you have internet issues leads to download failed, try again may help.</p>
</li>
<li>
<p>Use YOLOV5 v3.1</p>
</li>
<li>
<p>If you use Jetson Navier NX, this link might help to solve &ldquo;illegal instruction (core dumped)&rdquo; problem:</p>
<p><a href="https://forums.developer.nvidia.com/t/illegal-instruction-core-dumped-xavier/166278" target="_blank" rel="noopener">https://forums.developer.nvidia.com/t/illegal-instruction-core-dumped-xavier/166278</a></p>
<p>To be short, just install Numpy 1.19.4 by using:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip install <span style="color:#b8860b">numpy</span><span style="color:#666">==</span>1.19.4
</span></span></code></pre></div></li>
</ol>
<h2 id="these-are-the-outputs-i-got">These are the outputs I got: <a href="#these-are-the-outputs-i-got" class="anchor"></a></h2><p>Run it on testing images in the project file:
<p class="markdown-image">
  <img src="https://raw.githubusercontent.com/Richard-CokeCola/Richard-CokeCola.github.io/main/images/AI/IMG_9604.JPG" alt="&lsquo;Jetson output&rsquo;"  title="YOLOv5 running on Jetson nano" />
</p>
Run it on a <a href="https://www.youtube.com/watch?v=wqctLW0Hb_0&amp;t=11s" target="_blank" rel="noopener">Youtube video:</a>
<p class="markdown-image">
  <img src="https://raw.githubusercontent.com/Richard-CokeCola/Richard-CokeCola.github.io/main/images/AI/jetson-output-car.jpg" alt="&lsquo;Jetson output-car&rsquo;"  title="YOLOv5 running on Jetson nano" />
</p>
Run it on a pre-recorded office video:
<p class="markdown-image">
  <img src="https://raw.githubusercontent.com/Richard-CokeCola/Richard-CokeCola.github.io/main/images/AI/jetson-output.jpg" alt="&lsquo;Jetson output-office&rsquo;"  title="YOLOv5 running on Jetson nano" />
</p></p>
<h2 id="references"><em>References:</em> <a href="#references" class="anchor"></a></h2><ol>
<li><em>Pytorch深度学习框架X NVIDIA JetsonNano应用-YOLOv5辨识台湾实时路况</em> <a href="https://www.rs-online.com/designspark/pytorchx-nvidia-jetsonnano-yolov5-1-cn" target="_blank" rel="noopener">https://www.rs-online.com/designspark/pytorchx-nvidia-jetsonnano-yolov5-1-cn</a></li>
<li><em>How to Run YoloV5 Real-Time Object Detection on Pytorch with Docker on NVIDIA Jetson Modules</em> <a href="https://www.forecr.io/blogs/ai-algorithms/how-to-run-yolov5-real-time-object-detection-on-pytorch-with-docker-on-nvidia-jetson-modules" target="_blank" rel="noopener">https://www.forecr.io/blogs/ai-algorithms/how-to-run-yolov5-real-time-object-detection-on-pytorch-with-docker-on-nvidia-jetson-modules</a></li>
<li><a href="https://forums.developer.nvidia.com/c/agx-autonomous-machines/jetson-embedded-systems/jetson-nano/76" target="_blank" rel="noopener">https://forums.developer.nvidia.com/c/agx-autonomous-machines/jetson-embedded-systems/jetson-nano/76</a></li>
<li><em>Getting Started with Jetson Nano Developer Kit</em> <a href="https://developer.nvidia.com/embedded/learn/get-started-jetson-nano-devkit" target="_blank" rel="noopener">https://developer.nvidia.com/embedded/learn/get-started-jetson-nano-devkit</a></li>
<li><em>Jetson Nano 入门教程3 - 必备软件安装Pytorch TensorFlow</em> <a href="https://zhuanlan.zhihu.com/p/342504190" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/342504190</a></li>
<li><a href="https://forums.developer.nvidia.com/c/agx-autonomous-machines/jetson-embedded-systems/jetson-nano/76" target="_blank" rel="noopener">https://forums.developer.nvidia.com/c/agx-autonomous-machines/jetson-embedded-systems/jetson-nano/76</a></li>
<li>More method to install torchvision: <a href="https://shliang.blog.csdn.net/article/details/109862917" target="_blank" rel="noopener">https://shliang.blog.csdn.net/article/details/109862917</a></li>
<li><em>YOLOv5 TensorRT Benchmark for Jetson AGX Xavier and NVIDIA Laptop</em> <a href="https://www.forecr.io/blogs/ai-algorithms/yolov5-tensorrt-benchmark-for-jetson-agx-xavier-and-nvidia-laptop" target="_blank" rel="noopener">https://www.forecr.io/blogs/ai-algorithms/yolov5-tensorrt-benchmark-for-jetson-agx-xavier-and-nvidia-laptop</a></li>
</ol>

    </div>

    
        <div class="tags">
            
                <a href="https://richard-cokecola.github.io/tags/ai">AI</a>
            
                <a href="https://richard-cokecola.github.io/tags/jetson-developer-kit">Jetson developer kit</a>
            
                <a href="https://richard-cokecola.github.io/tags/tutorial"> tutorial </a>
            
        </div>
    
    
    
  <div id="comment">
    
    <div id="disqus_thread"></div>
<script>
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "https-richard-cokecola-github-io" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </div>


</section>


    </main>
    
    <footer id="footer">
    

    <div class="copyright">
    
        An engineer who is interested in AI, music, cooking, and some other things. You can contact me via email: <a href="mailto:richardwei@protonmail.com">richardwei@protonmail.com</a>
    
    </div>

    
      <div class="powerby">
        Site by <a href="https://richard-cokecola.github.io">Richard</a> Theme By <a href="https://github.com/nodejh/hugo-theme-cactus-plus">nodejh</a>
      </div>
    
</footer>



  </body>
</html>
